# Garden Calm

Garden Calm — система эмоционального анализа и поддержки, использующая LLM (Haiku, DeepSeek) для диалога и анализа эмоций пользователя.

## Текущий статус проекта

Проект успешно реорганизован для устранения циклических зависимостей между пакетами. Основная проблема заключалась в том, что core и storage имели взаимные зависимости, что делало невозможной корректную сборку TypeScript declarations (dts).

**Общий прогресс проекта: 100%**

Подробная информация о прогрессе, выполненных задачах, а также рекомендации для будущих разработчиков доступны в файле [PROGRESS.md](./PROGRESS.md).

## Структура проекта

```
garden-calm/
├── apps/                  # Приложения
│   ├── api/               # API сервер
│   └── web/               # Веб-интерфейс
├── packages/              # Пакеты
│   ├── core/              # Основная логика
│   ├── storage/           # Хранилище данных
│   ├── types/             # Общие типы
│   ├── config/            # Конфигурация
│   └── ui/                # UI компоненты
├── infra/                 # Инфраструктура
├── tests/                 # Тесты
└── docs/                  # Документация
```

## Требования

- Node.js >= 18.0.0
- pnpm >= 8.0.0

## Быстрый старт

### 1. Установка зависимостей

```bash
# Установка pnpm (если не установлен)
npm install -g pnpm

# Установка зависимостей проекта
pnpm install
```

### 2. Настройка окружения

```bash
# Создание файла .env на основе примера
cp .env.example .env

# Отредактируйте .env файл, указав необходимые значения
# Особенно важно указать V3_API_KEY для работы с API
```

### 3. Сборка и запуск

```bash
# Сборка всех пакетов
pnpm build

# Запуск API сервера в режиме разработки
pnpm dev
```

### 4. Доступ к приложению

- API сервер будет доступен по адресу: http://localhost:3000
- Веб-интерфейс (при запуске отдельно): http://localhost:5173

## Разработка

```bash
# Сборка отдельных пакетов (в правильном порядке)
cd packages/types && pnpm build
cd ../core && pnpm build
cd ../storage && pnpm build
cd ../../apps/api && pnpm build

# Запуск веб-интерфейса отдельно
cd apps/web && pnpm dev
```

## Ключевые компоненты

- **Emotion Matrix**: Матрица эмоций и их характеристик
- **V3 Adapter**: Адаптер для работы с DeepSeek V3
- **Scoring Engine**: Движок оценки эмоционального состояния
- **Context Manager**: Управление контекстом диалога
- **Suggestion Engine**: Движок предложений для медитации
- **Decision Engine**: Движок принятия решений
- **Empathy Orchestrator**: Оркестратор эмпатии, координирующий все компоненты

## WebSocket API

Проект использует WebSocket для обмена сообщениями в реальном времени. Подключение доступно по адресу `ws://localhost:3000`.

### Типы сообщений:
- `message`: Отправка сообщения пользователя
- `analysis`: Получение результата анализа
- `meditation_suggestion`: Предложение медитации
- `meditation_response`: Ответ на предложение медитации

## REST API

Доступны следующие REST эндпоинты:
- `POST /api/message`: Отправка сообщения и получение ответа
- `GET /api/health`: Проверка работоспособности API

## Лицензия

Проект является частной разработкой и не подлежит распространению без согласия владельца.
